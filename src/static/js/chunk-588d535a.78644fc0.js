(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-588d535a"],{"679f":function(e,t,r){"use strict";var s=r("8578"),a=r.n(s);a.a},8578:function(e,t,r){},f9d2:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"school-info"},[r("el-card",{staticClass:"base-card"},[r("div",{staticClass:"base-header",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("基本信息")]),e.school.isEdit?r("el-button",{attrs:{type:"text"},on:{click:e.saveSchoolBaseInfo}},[e._v("保存")]):r("el-button",{attrs:{type:"text"},on:{click:function(t){e.school.isEdit=!0}}},[e._v("编辑基本信息")])],1),r("el-form",{ref:e.school.ID,staticClass:"base-form",attrs:{model:e.school,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{staticClass:"base-form-item",attrs:{label:"名称：",prop:"name"}},[e.school.isEdit?r("el-input",{attrs:{placeholder:"请输入教学点名称"},model:{value:e.school.name,callback:function(t){e.$set(e.school,"name",t)},expression:"school.name"}}):r("p",[e._v(e._s(e.school.name))])],1),r("el-form-item",{staticClass:"base-form-item",attrs:{label:"类型：",prop:"type"}},[e.school.isEdit?r("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.school.type,callback:function(t){e.$set(e.school,"type",t)},expression:"school.type"}},e._l(e.schoolTypeOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):r("p",[e._v(e._s((e.schoolTypeOptions.find((function(t){return t.value===e.school.type}))||{}).label))])],1),r("el-form-item",{staticClass:"base-form-item",attrs:{label:"地址：",prop:"location"}},[e.school.isEdit?r("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.school.location,callback:function(t){e.$set(e.school,"location",t)},expression:"school.location"}}):r("p",[e._v(e._s(e.school.location))])],1),r("el-form-item",{staticClass:"base-form-item",attrs:{label:"电话：",prop:"tel"}},[e.school.isEdit?r("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.school.tel,callback:function(t){e.$set(e.school,"tel",t)},expression:"school.tel"}}):r("p",[e._v(e._s(e.school.tel))])],1),r("el-form-item",{staticClass:"base-form-item",attrs:{label:"账号：",prop:"account"}},[r("p",[e._v(e._s(e.school.account))])]),r("el-form-item",{staticClass:"base-form-item",attrs:{label:"密码：",prop:"passwords"}},[e.school.isEdit?r("el-input",{attrs:{placeholder:"请输入密码"},model:{value:e.school.passwords,callback:function(t){e.$set(e.school,"passwords",t)},expression:"school.passwords"}}):r("p",[e._v(e._s(e.school.passwords))])],1)],1)],1)],1)},a=[],o=(r("4178"),r("86dd"),r("33c4"),r("af82"),r("1a8c"),r("c354"),r("3f36"),r("f4dd"),r("79dd"),r("3a20"),r("7267"),r("9a14"),r("289c")),n=r("5a3e"),c=(r("63ff"),r("57f0")),i=r("ef5c"),l=r("6144"),u=r("94e6"),d=r.n(u);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f={name:"SchoolInfo",data:function(){return{school:{},addDeviceDrawer:!1,addDeviceLoading:!1,addDeviceFrom:{name:"",device_number:null,device_model:null,type:1,product_time:Date.now(),start_time:Date.now(),end_time:Date.now(),school:null,device_status:0},rules:{name:[{required:!0,message:"请输入名称",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],location:[{required:!0,message:"请输入地址",trigger:"change"}],tel:[{required:!0,message:"请输入电话",trigger:"change"}],account:[{required:!0,message:"请输入账号",trigger:"change"}],passwords:[{required:!0,message:"请输入密码",trigger:"change"}],device_status:[{required:!0,message:"请输选择状态",trigger:"change"}]},schoolTypeOptions:[{value:1,label:"教学点"},{value:2,label:"中心校"}],deviceStatusOptions:[{value:0,label:"正常"},{value:1,label:"待维修"},{value:2,label:"报废"}],deviceTypeOptions:[{value:1,label:"屏幕"},{value:2,label:"摄像头"},{value:3,label:"话筒"},{value:4,label:"多媒体计算机"}]}},created:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["a"][l["d"]].getSchool().then((function(e){var t=Object(n["a"])(e,1),r=t[0];return h({},r,{isEdit:!1,devices:r.devices.map((function(e){return h({},e,{isEdit:!1})}))})}));case 2:e.school=t.sent;case 3:case"end":return t.stop()}}),t)})))()},methods:{mapSchool:function(e){return e.isEdit=!1,e.devices&&(e.devices=e.devices.map((function(e){return e.isEdit=!1,e}))),e},saveSchoolBaseInfo:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs[e.school.ID].validate(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(r){var s,a,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.next=3,i["a"][l["d"]].saveSchool(e.school).catch((function(t){return e.$message.error(t.toString())}));case 3:s=t.sent,a=Object(n["a"])(s,1),o=a[0],c=e.school.devices,console.log(e.mapSchool),e.school=h({},e.mapSchool(o),{devices:c}),e.$message.success("更新成功"),t.next=13;break;case 12:e.$message.error("请填写相关基本信息");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},saveSchoolDevice:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,a,o,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(d()(e.name)||d()(e.device_status)){r.next=11;break}return r.next=3,i["a"][l["d"]].saveDevice(e).catch((function(e){return t.$message.error(e.toString())}));case 3:s=r.sent,a=Object(n["a"])(s,1),o=a[0],c=t.school.devices.findIndex((function(e){return e.ID===o.ID})),t.$set(t.school.devices,c,h({},o,{isEdit:!1})),t.$message.success("更新成功"),r.next=12;break;case 11:t.$message.error("请填写相关设备信息");case 12:case"end":return r.stop()}}),r)})))()},addDevice:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.addDeviceLoading=!0,e.$refs["addDevices"].validate(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(r){var s,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=11;break}return t.next=3,i["a"][l["d"]].addDevice(h({},e.addDeviceFrom,{school:e.school.ID})).catch((function(t){return e.$message.error(t.toString())}));case 3:s=t.sent,a=Object(n["a"])(s,1),o=a[0],e.school.devices.push(h({},o,{isEdit:!1})),e.addDeviceDrawer=!1,e.$message.success("添加成功"),t.next=12;break;case 11:e.$message.error("请填写相关基本信息");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.addDeviceLoading=!1;case 3:case"end":return t.stop()}}),t)})))()}}},m=f,v=(r("679f"),r("5511")),b=Object(v["a"])(m,s,a,!1,null,"2cd012f8",null);t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-588d535a.78644fc0.js.map