(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01678b58"],{"4ad8":function(e,t,o){"use strict";var a=o("ac66"),r=o.n(a);r.a},"51e6":function(e,t,o){},"94d3":function(e,t,o){"use strict";var a=o("51e6"),r=o.n(a);r.a},ac66:function(e,t,o){},b459:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"schoolManage"},[o("el-button",{staticClass:"add-school-button",attrs:{type:"text"},on:{click:function(t){e.addSchoolDrawer=!0}}},[o("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加教学点")]),o("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.schools,(function(t){return o("school-manage-item",{key:t.ID,attrs:{school:t},on:{update:e.updateSchool}})})),1),o("el-drawer",{attrs:{"with-header":!1,visible:e.addSchoolDrawer,direction:"rtl"},on:{"update:visible":function(t){e.addSchoolDrawer=t}}},[o("div",{staticClass:"add-school-drawer"},[o("el-form",{attrs:{model:e.addSchoolFrom,rules:e.rules}},[o("el-form-item",{attrs:{label:"名称：",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入教学点名称"},model:{value:e.addSchoolFrom.name,callback:function(t){e.$set(e.addSchoolFrom,"name",t)},expression:"addSchoolFrom.name"}})],1),o("el-form-item",{attrs:{label:"类型：",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.addSchoolFrom.type,callback:function(t){e.$set(e.addSchoolFrom,"type",t)},expression:"addSchoolFrom.type"}},e._l(e.schoolTypeOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-form-item",{attrs:{label:"地址：",prop:"location"}},[o("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.addSchoolFrom.location,callback:function(t){e.$set(e.addSchoolFrom,"location",t)},expression:"addSchoolFrom.location"}})],1),o("el-form-item",{attrs:{label:"电话：",prop:"tel"}},[o("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.addSchoolFrom.tel,callback:function(t){e.$set(e.addSchoolFrom,"tel",t)},expression:"addSchoolFrom.tel"}})],1),o("el-form-item",{attrs:{label:"账号：",prop:"account"}},[o("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.addSchoolFrom.account,callback:function(t){e.$set(e.addSchoolFrom,"account",t)},expression:"addSchoolFrom.account"}})],1),o("el-form-item",{attrs:{label:"密码：",prop:"passwords"}},[o("el-input",{attrs:{placeholder:"请输入密码"},model:{value:e.addSchoolFrom.passwords,callback:function(t){e.$set(e.addSchoolFrom,"passwords",t)},expression:"addSchoolFrom.passwords"}})],1)],1),o("div",{staticClass:"demo-drawer__footer"},[o("el-button",{on:{click:function(t){e.addSchoolDrawer=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary",loading:e.addSchoolLoading},on:{click:e.addSchoolInfo}},[e._v(e._s(e.addSchoolLoading?"提交中 ...":"确 定"))])],1)],1)])],1)},r=[],l=(o("4178"),o("86dd"),o("33c4"),o("af82"),o("1a8c"),o("c354"),o("3f36"),o("f4dd"),o("79dd"),o("3a20"),o("7267"),o("9a14"),o("289c")),s=o("5a3e"),c=(o("63ff"),o("57f0")),i=o("ef5c"),n=o("6144"),d=o("94e6"),u=o.n(d),p=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-collapse-item",{staticClass:"school-header",attrs:{title:e.school.name,name:e.school.ID}},[o("div",{staticClass:"base-cards"},[o("el-card",{staticClass:"base-card"},[o("div",{staticClass:"base-header",attrs:{slot:"header"},slot:"header"},[o("span",[e._v("基本信息")]),e.school.isEdit?o("el-button",{attrs:{type:"text"},on:{click:e.saveSchoolBaseInfo}},[e._v("保存")]):o("el-button",{attrs:{type:"text"},on:{click:function(t){e.school.isEdit=!0}}},[e._v("编辑基本信息")])],1),o("el-form",{ref:e.school.ID,staticClass:"base-form",attrs:{model:e.school,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{staticClass:"base-form-item",attrs:{label:"名称：",prop:"name"}},[e.school.isEdit?o("el-input",{attrs:{placeholder:"请输入教学点名称"},model:{value:e.school.name,callback:function(t){e.$set(e.school,"name",t)},expression:"school.name"}}):o("p",[e._v(e._s(e.school.name))])],1),o("el-form-item",{staticClass:"base-form-item",attrs:{label:"类型：",prop:"type"}},[e.school.isEdit?o("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.school.type,callback:function(t){e.$set(e.school,"type",t)},expression:"school.type"}},e._l(e.schoolTypeOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):o("p",[e._v(e._s(e.schoolTypeOptions.find((function(t){return t.value===e.school.type})).label))])],1),o("el-form-item",{staticClass:"base-form-item",attrs:{label:"地址：",prop:"location"}},[e.school.isEdit?o("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.school.location,callback:function(t){e.$set(e.school,"location",t)},expression:"school.location"}}):o("p",[e._v(e._s(e.school.location))])],1),o("el-form-item",{staticClass:"base-form-item",attrs:{label:"电话：",prop:"tel"}},[e.school.isEdit?o("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.school.tel,callback:function(t){e.$set(e.school,"tel",t)},expression:"school.tel"}}):o("p",[e._v(e._s(e.school.tel))])],1),o("el-form-item",{staticClass:"base-form-item",attrs:{label:"账号：",prop:"account"}},[e.school.isEdit?o("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.school.account,callback:function(t){e.$set(e.school,"account",t)},expression:"school.account"}}):o("p",[e._v(e._s(e.school.account))])],1),o("el-form-item",{staticClass:"base-form-item",attrs:{label:"密码：",prop:"passwords"}},[e.school.isEdit?o("el-input",{attrs:{placeholder:"请输入密码"},model:{value:e.school.passwords,callback:function(t){e.$set(e.school,"passwords",t)},expression:"school.passwords"}}):o("p",[e._v(e._s(e.school.passwords))])],1)],1)],1),o("el-card",{staticClass:"base-card"},[o("div",{staticClass:"base-header",attrs:{slot:"header"},slot:"header"},[o("span",[e._v("设备信息")])]),o("el-button",{staticClass:"add-device-button",attrs:{type:"text"},on:{click:function(t){e.addDeviceDrawer=!0}}},[o("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加设备 ")]),o("el-table",{staticStyle:{width:"780px"},attrs:{data:e.school.devices,stripe:"","header-row-class-name":function(){return"device-table-header"}}},[o("el-table-column",{attrs:{fixed:"","show-overflow-tooltip":"",label:"名称",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-input",{attrs:{placeholder:"请输入名称"},model:{value:t.row.name,callback:function(o){e.$set(t.row,"name",o)},expression:"scope.row.name"}}):o("p",[e._v(e._s(t.row.name))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-select",{attrs:{placeholder:"请选择类型"},model:{value:t.row.type,callback:function(o){e.$set(t.row,"type",o)},expression:"scope.row.type"}},e._l(e.deviceTypeOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):o("p",[e._v(e._s(e.deviceTypeOptions.find((function(e){return e.value===t.row.type})).label))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"编号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-input",{attrs:{placeholder:"请输入编号"},model:{value:t.row.device_number,callback:function(o){e.$set(t.row,"device_number",o)},expression:"scope.row.device_number"}}):o("p",[e._v(e._s(t.row.device_number))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"型号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-input",{attrs:{placeholder:"请输入型号"},model:{value:t.row.device_model,callback:function(o){e.$set(t.row,"device_model",o)},expression:"scope.row.device_model"}}):o("p",[e._v(e._s(t.row.device_model))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"生产日期",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy/M/dd","value-format":"timestamp"},model:{value:t.row.product_time,callback:function(o){e.$set(t.row,"product_time",o)},expression:"scope.row.product_time"}}):o("p",[e._v(e._s(e._f("formatterDate")(t.row.product_time)))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"安装时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy/M/dd","value-format":"timestamp"},model:{value:t.row.start_time,callback:function(o){e.$set(t.row,"start_time",o)},expression:"scope.row.start_time"}}):o("p",[e._v(e._s(e._f("formatterDate")(t.row.start_time)))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"预计报废时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy/M/dd","value-format":"timestamp"},model:{value:t.row.end_time,callback:function(o){e.$set(t.row,"end_time",o)},expression:"scope.row.end_time"}}):o("p",[e._v(e._s(e._f("formatterDate")(t.row.end_time)))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"设备状态",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.row.device_status,callback:function(o){e.$set(t.row,"device_status",o)},expression:"scope.row.device_status"}},e._l(e.deviceStatusOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):o("p",[e._v(e._s(e.deviceStatusOptions.find((function(e){return e.value===t.row.device_status})).label))])]}}])}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){return e.saveSchoolDevice(t.row)}}},[e._v("保存")]):o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){t.row.isEdit=!0}}},[e._v("编辑")])]}}])})],1)],1)],1)]),o("el-drawer",{attrs:{"with-header":!1,visible:e.addDeviceDrawer,direction:"rtl"},on:{"update:visible":function(t){e.addDeviceDrawer=t}}},[o("div",{staticClass:"add-school-drawer"},[o("el-form",{ref:"addDevices",attrs:{model:e.addDeviceFrom,rules:e.rules}},[o("el-form-item",{attrs:{label:"名称：",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.addDeviceFrom.name,callback:function(t){e.$set(e.addDeviceFrom,"name",t)},expression:"addDeviceFrom.name"}})],1),o("el-form-item",{attrs:{label:"编号：",prop:"device_number"}},[o("el-input",{attrs:{placeholder:"请输入编号"},model:{value:e.addDeviceFrom.device_number,callback:function(t){e.$set(e.addDeviceFrom,"device_number",t)},expression:"addDeviceFrom.device_number"}})],1),o("el-form-item",{attrs:{label:"型号：",prop:"device_model"}},[o("el-input",{attrs:{placeholder:"请输入型号"},model:{value:e.addDeviceFrom.device_model,callback:function(t){e.$set(e.addDeviceFrom,"device_model",t)},expression:"addDeviceFrom.device_model"}})],1),o("el-form-item",{attrs:{label:"类型：",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.addDeviceFrom.type,callback:function(t){e.$set(e.addDeviceFrom,"type",t)},expression:"addDeviceFrom.type"}},e._l(e.deviceTypeOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-form-item",{attrs:{label:"生产时间：",prop:"product_time"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy/M/dd","value-format":"timestamp"},model:{value:e.addDeviceFrom.product_time,callback:function(t){e.$set(e.addDeviceFrom,"product_time",t)},expression:"addDeviceFrom.product_time"}})],1),o("el-form-item",{attrs:{label:"安装时间：",prop:"start_time"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy/M/dd","value-format":"timestamp"},model:{value:e.addDeviceFrom.start_time,callback:function(t){e.$set(e.addDeviceFrom,"start_time",t)},expression:"addDeviceFrom.start_time"}})],1),o("el-form-item",{attrs:{label:"预计报废时间：",prop:"end_time"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy/M/dd","value-format":"timestamp"},model:{value:e.addDeviceFrom.end_time,callback:function(t){e.$set(e.addDeviceFrom,"end_time",t)},expression:"addDeviceFrom.end_time"}})],1),o("el-form-item",{attrs:{label:"设备状态",prop:"device_status"}},[o("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.addDeviceFrom.device_status,callback:function(t){e.$set(e.addDeviceFrom,"device_status",t)},expression:"addDeviceFrom.device_status"}},e._l(e.deviceStatusOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),o("div",{staticClass:"demo-drawer__footer"},[o("el-button",{on:{click:function(t){e.addDeviceDrawer=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary",loading:e.addDeviceLoading},on:{click:e.addDevice}},[e._v(e._s(e.addDeviceLoading?"提交中 ...":"确 定"))])],1)],1)])],1)},m=[];function v(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function h(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?v(Object(o),!0).forEach((function(t){Object(l["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):v(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var f={props:{school:{}},data:function(){return{schoolTypeOptions:[{value:1,label:"教学点"},{value:2,label:"中心校"}],deviceStatusOptions:[{value:0,label:"正常"},{value:1,label:"待维修"},{value:2,label:"报废"}],deviceTypeOptions:[{value:1,label:"屏幕"},{value:2,label:"摄像头"},{value:3,label:"话筒"},{value:4,label:"多媒体计算机"}],rules:{name:[{required:!0,message:"请输入名称",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],location:[{required:!0,message:"请输入地址",trigger:"change"}],tel:[{required:!0,message:"请输入电话",trigger:"change"}],account:[{required:!0,message:"请输入账号",trigger:"change"}],passwords:[{required:!0,message:"请输入密码",trigger:"change"}],device_status:[{required:!0,message:"请输选择状态",trigger:"change"}]},addDeviceDrawer:!1,addDeviceFrom:{name:"",device_number:"",device_model:"",type:1,product_time:Date.now(),start_time:Date.now(),end_time:Date.now(),school:"",device_status:0},addDeviceLoading:!1}},methods:{mapSchool:function(e){return e.isEdit=!1,e.devices&&(e.devices=e.devices.map((function(e){return e.isEdit=!1,e}))),e},saveSchoolBaseInfo:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs[e.school.ID].validate(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(o){var a,r,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!o){t.next=11;break}return t.next=3,i["a"][n["a"]].saveSchool(e.school).catch((function(t){return e.$message.error(t.toString())}));case 3:a=t.sent,r=Object(s["a"])(a,1),l=r[0],c=e.school.devices,e.$emit("update",h({},e.mapSchool(l),{devices:c})),e.$message.success("更新成功"),t.next=12;break;case 11:e.$message.error("请填写相关基本信息");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},saveSchoolDevice:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function o(){var a,r,l,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(u()(e.name)||u()(e.device_status)){o.next=12;break}return o.next=3,i["a"][n["a"]].saveDevice(e).catch((function(e){return t.$message.error(e.toString())}));case 3:a=o.sent,r=Object(s["a"])(a,1),l=r[0],c=t.school.devices.findIndex((function(e){return e.ID===l.ID})),t.$set(t.school.devices,c,h({},l,{isEdit:!1})),t.$emit("update",t.school),t.$message.success("更新成功"),o.next=13;break;case 12:t.$message.error("请填写相关设备信息");case 13:case"end":return o.stop()}}),o)})))()},addDevice:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.addDeviceLoading=!0,e.$refs["addDevices"].validate(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(o){var a,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!o){t.next=12;break}return t.next=3,i["a"][n["a"]].addDevice(h({},e.addDeviceFrom,{school:e.school.ID})).catch((function(t){return e.$message.error(t.toString())}));case 3:a=t.sent,r=Object(s["a"])(a,1),l=r[0],e.school.devices.push(h({},l,{isEdit:!1})),e.$emit("update",e.school),e.addDeviceDrawer=!1,e.$message.success("添加成功"),t.next=13;break;case 12:e.$message.error("请填写相关基本信息");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.addDeviceLoading=!1;case 3:case"end":return t.stop()}}),t)})))()}}},b=f,w=(o("4ad8"),o("5511")),_=Object(w["a"])(b,p,m,!1,null,null,null),g=_.exports;function y(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function D(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?y(Object(o),!0).forEach((function(t){Object(l["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var k={name:"schoolManage",components:{SchoolManageItem:g},data:function(){return{schools:[],activeName:0,addSchoolDrawer:!1,addSchoolFrom:{name:"",type:1,location:"",tel:"",account:"",passwords:""},schoolTypeOptions:[{value:1,label:"教学点"},{value:2,label:"中心校"}],rules:{name:[{required:!0,message:"请输入名称",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],location:[{required:!0,message:"请输入地址",trigger:"change"}],tel:[{required:!0,message:"请输入电话",trigger:"change"}],account:[{required:!0,message:"请输入账号",trigger:"change"}],passwords:[{required:!0,message:"请输入密码",trigger:"change"}],device_status:[{required:!0,message:"请输选择状态",trigger:"change"}]},addSchoolLoading:!1}},created:function(){var e=this;i["a"][n["a"]].getAllSchool().then((function(t){e.schools=t.map((function(t){return e.mapSchool(t)})),e.activeName=e.schools[0].ID})).catch((function(t){return e.$message.error(t.toString())}))},methods:{mapSchool:function(e){return e.isEdit=!1,e.devices&&(e.devices=e.devices.map((function(e){return e.isEdit=!1,e}))),e},updateSchool:function(e){var t=this.schools.findIndex((function(t){return t.ID===e.ID}));this.$set(this.schools,t,e)},addSchoolInfo:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var o,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.addSchoolLoading=!0,!(e.addSchoolFrom.name&&!u()(e.addSchoolFrom.type)&&e.addSchoolFrom.location&&e.addSchoolFrom.tel&&e.addSchoolFrom.account&&e.addSchoolFrom.passwords)){t.next=12;break}return t.next=4,i["a"][n["a"]].addSchool(e.addSchoolFrom).catch((function(t){return e.$message.error(t.toString())}));case 4:o=t.sent,a=Object(s["a"])(o,1),r=a[0],e.schools.push(D({},e.mapSchool(r),{devices:[]})),e.addSchoolDrawer=!1,e.$message.success("添加成功"),t.next=13;break;case 12:e.$message.error("请填写相关基本信息");case 13:e.addSchoolLoading=!1;case 14:case"end":return t.stop()}}),t)})))()}}},S=k,x=(o("94d3"),Object(w["a"])(S,a,r,!1,null,null,null));t["default"]=x.exports}}]);
//# sourceMappingURL=chunk-01678b58.c8c0960a.js.map